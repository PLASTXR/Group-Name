<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Games</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous"> <!--Bootstrap CSS-->
</head>

<style>
    nav{
        background: #418241;
        background: linear-gradient(0deg, rgba(65, 130, 65, 1) 0%, rgba(117, 178, 120, 1) 100%);
        border-bottom-left-radius: 1vw ;
        border-bottom-right-radius: 1vw ;
    }
    .btn{
        background: linear-gradient(#69AD5F, #418241);
        border-radius: 17px;
    }
    .btn:hover{
        transform:scale(1.05);
        box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    body{
        background-color:#c1e3c3;
        margin-top: 15vh;
    }
    .game-ratings-container{
        display: flex;
        justify-content: center;
        padding: 12px 0;
    }
    .game-rating{
        display: flex;
        align-items: center;
        cursor: default;
    }
    .game-rating:not(:last-child){
        margin-right: 12px;
    }
    .game-rating-button{
        margin-right: 4px;
        cursor: pointer;
        color: #212529;
    }
    .game-rating-selected > .game-rating-button,
    .game-rating-selected > .game-rating-count {
        color:#69AD5F;
    }
    .game-rating:not(.game-rating-selected) > .game-rating-button:hover {
        color: black;
    }

</style>

<nav class="navbar fixed-top">
    <div class="container"><h1>Memorisation Games</h1>
        <a class="navbar-brand" href="login.html" style="color: #212529;"> Log In
            <i class="bi bi-person-circle"></i>
        </a>
    </div>
</nav>
<body>
    <div class="container">
        <div class="d-inline-flex row g-5">
            <div class="d-inline-flex col p-5">
                <div class="card text-center shadow p-3 mb-5 bg-body-tertiary rounded" style="width: 18rem;">
                    <img src="#" class="card-img-top" alt="...">
                    <div class="card-body">
                      <h5 class="card-title">Match The Cards</h5>
                      <p class="card-text">Click on cards to find pairs. If two of the same card are found one after the other then you have successfully found a pair</p>
                      <a href="MatchTheCards.html" class="btn">Play</a>
                    </div>
                    <div class="card-footer">
                        <div class="game" data-game-id="1">
                        <div class="game-ratings-container">
                            <div class="game-rating">
                                <i class="game-rating-button bi bi-hand-thumbs-up"></i>
                                <span class="game-rating-count">0</span>
                            </div>
                            <div class="game-rating">
                                <i class="game-rating-button bi bi-hand-thumbs-down"></i>
                                <span class="game-rating-count">0</span>
                            </div>
                            <div class="game-rating bookmark">
                                <i class="game-rating-button bi-bookmark"></i>
                                <span class="game-rating-count">0</span>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
            <div class="d-inline-flex col p-5">
                <div class="card text-center shadow p-3 mb-5 bg-body-tertiary rounded" style="width: 18rem;">
                    <img src="#" class="card-img-top" alt="...">
                    <div class="card-body">
                      <h5 class="card-title">Colour Order</h5>
                      <p class="card-text">Remember the order in which to press the buttons</p>
                      <a href="ColourOrder.html" class="btn">Play</a>
                    </div>
                    <div class="card-footer">
                        <div class="game" data-game-id="2">
                            <div class="game-ratings-container">
                                <div class="game-rating">
                                    <i class="game-rating-button bi bi-hand-thumbs-up"></i>
                                    <span class="game-rating-count">0</span>
                                </div>
                                <div class="game-rating">
                                    <i class="game-rating-button bi bi-hand-thumbs-down"></i>
                                    <span class="game-rating-count">0</span>
                                </div>
                                <div class="game-rating bookmark">
                                    <i class="game-rating-button bi-bookmark"></i>
                                    <span class="game-rating-count">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                  </div>
            </div>
            <div class="d-inline-flex col p-5">
                <div class="card text-center shadow p-3 mb-5 bg-body-tertiary rounded" style="width: 18rem;">
                    <img src="#" class="card-img-top" alt="...">
                    <div class="card-body">
                      <h5 class="card-title">Clicker</h5>
                      <p class="card-text"> this is definitely not gambling</p>
                      <a href="Clicker.html" class="btn">Play</a>
                    </div>
                    <div class="card-footer">
                        <div class="game" data-game-id="3">
                            <div class="game-ratings-container">
                                <div class="game-rating">
                                    <i class="game-rating-button bi bi-hand-thumbs-up"></i>
                                    <span class="game-rating-count">0</span>
                                </div>
                                <div class="game-rating">
                                    <i class="game-rating-button bi bi-hand-thumbs-down"></i>
                                    <span class="game-rating-count">0</span>
                                </div>
                                <div class="game-rating bookmark">
                                    <i class="game-rating-button bi-bookmark"></i>
                                    <span class="game-rating-count">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
	</div>
    </div>
    <script>
        document.querySelectorAll(".game").forEach(game => {
            const gameId = game.dataset.gameId;
            const ratings = game.querySelectorAll(".game-rating"); 
            const likeRating = ratings[0]; 
            ratings.forEach(rating => {
                const button = rating.querySelector(".game-rating-button"); 
                const count = rating.querySelector(".game-rating-count"); 
                button.addEventListener("click", async () => {
                    
                    //bookmark handling
                    if(rating.classList.contains("bookmark")){
                        const count = rating.querySelector(".game-rating-count");
    
                        // if bookmark is already selected it deselects???
                        if (rating.classList.contains("game-rating-selected")){
                            rating.classList.remove("game-rating-selected");
                            count.textContent=Math.max(0, Number(count.textContent) -1);
                            button.classList.remove("bi-bookmark-fill");
                            button.classList.add("bi-bookmark");
                                
                        } else{ //otherwise it selects
                            rating.classList.add("game-rating-selected");
                            count.textContent=Number(count.textContent) +1;
                            button.classList.remove("bi-bookmark");
                            button.classList.add("bi-bookmark-fill");
                        }
                        
                        return;
                    }
                    
                    
                    //likes and dislikes handling
    
                    //if the button clicked is selected it deselects
                    if (rating.classList.contains("game-rating-selected")){
                        rating.classList.remove("game-rating-selected");
                        count.textContent=Math.max(0, Number(count.textContent) -1);
                        if (button.classList.contains("bi-hand-thumbs-up-fill")){
                            button.classList.remove("bi-hand-thumbs-up-fill");
                            button.classList.add("bi-hand-thumbs-up");
                        }
                        if (button.classList.contains("bi-hand-thumbs-down-fill")){
                            button.classList.remove("bi-hand-thumbs-down-fill");
                            button.classList.add("bi-hand-thumbs-down");
                        }
                       return;
                    }
                    
                    count.textContent=Number(count.textContent) +1;
                    ratings.forEach(rating => {
                        //If a different button is selected already it removes the selection from that button
                        if(rating.classList.contains("game-rating-selected")){
    
                            // unless its the bookmark button
                            if(rating.classList.contains("bookmark")){
                                return;
                            } else{
                                const count = rating.querySelector(".game-rating-count");
                                const button2 = rating.querySelector(".game-rating-button");
                                count.textContent=Math.max(0, Number(count.textContent) -1);
                                rating.classList.remove("game-rating-selected");
    
                                if (button2.classList.contains("bi-hand-thumbs-up-fill")){
                                    button2.classList.remove("bi-hand-thumbs-up-fill");
                                    button2.classList.add("bi-hand-thumbs-up");
                                }
                                if (button2.classList.contains("bi-hand-thumbs-down-fill")){
                                    button2.classList.remove("bi-hand-thumbs-down-fill");
                                    button2.classList.add("bi-hand-thumbs-down");
                                }
                            }
                        }
                    });
                    //since the button clicked would not be not selected, it adds
                    rating.classList.add("game-rating-selected");
                    if (button.classList.contains("bi-hand-thumbs-up")){
                        button.classList.remove("bi-hand-thumbs-up");
                        button.classList.add("bi-hand-thumbs-up-fill");
                    }
                    if (button.classList.contains("bi-hand-thumbs-down")){
                        button.classList.remove("bi-hand-thumbs-down");
                        button.classList.add("bi-hand-thumbs-down-fill");
                    }
                    const likeOrDislike = likeRating === rating ? "like" : "dislike";
                    const response = await fetch(`/games/${gameId}/${likeOrDislike}`); 
                    const body = await response.json();
                });
            }); 
    }); 
    </script>
</body>
</html>